{% extends "base.html" %}

{% block content %}
  <h1>Ger's Garage Reservation Form</h1>

  <form id="bookingForm" method="POST" action="/add_booking">
    <label for="licenceDetails">License Plate Number:</label>
    <select name="licence_details" id="licenceDetails" required>
      {% for vehicle in vehicles %}
      <option value="{{ vehicle[4] }}">{{ vehicle[4] }}</option>
      {% endfor %}
    </select><br><br>

    <label for="bookingType">Booking Type:</label>
    <select name="booking_type" id="bookingType" required>
      <option value="AnnualService">Annual Service</option>
      <option value="MajorService">Major Service</option>
      <option value="Repair">Repair/Fault</option>
      <option value="MajorRepair">Major Repair</option>
    </select><br><br>

    <label for="bookingDate">Booking Date:</label>
    <input type="date" name="booking_date" id="bookingDate" required><br><br>

    <label for="userComments">Customer Comments:</label>
    <textarea name="user_comments" id="userComments" rows="4"></textarea><br><br>

    <button type="submit">Make Reservation</button>
  </form>

  <!-- Başarılı mesajını göstermek için div elementi -->
  <div id="successMessage" style="display: none;">
    Booking successful. Redirecting to the booking page...
  </div>

  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='add_vehicle.css') }}">

  <script>
    // Get the date input element
    const bookingDateInput = document.getElementById("bookingDate");

    // Get today's date and set it as the min attribute for the date input
    const today = new Date().toISOString().split("T")[0];
    bookingDateInput.setAttribute("min", today);

    // Disable Sundays (day 0) in the date input
    bookingDateInput.addEventListener("input", function () {
      const selectedDate = new Date(bookingDateInput.value);
      if (selectedDate.getDay() === 0) {
        alert("Sundays are not allowed for booking. Please choose a different date.");
        bookingDateInput.value = "";
      }
    });

    // Show success message for 3 seconds and then redirect to the booking page
    const successMessage = document.getElementById("successMessage");
    const bookingForm = document.getElementById("bookingForm");
    bookingForm.addEventListener("submit", function (event) {
      event.preventDefault();
      successMessage.style.display = "block";
      setTimeout(function () {
        successMessage.style.display = "none";
        bookingForm.submit();
      }, 3000); // 3 seconds
    });

  </script>

{% endblock %}
